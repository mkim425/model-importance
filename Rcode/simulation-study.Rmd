---
title: "Simulation Study"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
theme_set(theme_bw())
library(here)
setwd(here())
```

# Association between a component forecaster's point prediction and importance 

```{r}
dat <- readRDS("../Data/simulation_f3pts.rds")
dat %>% 
    ggplot(aes(x=f3_pred, y =Importance_score, group=Model)) +
    geom_line(aes(linetype=Model)) +
    scale_linetype_manual(values=c("dashed","twodash", "solid")) +
    labs(x="b (prediction of forecaster 3)", y="Importance")
```


## Association between a component forecaster's bias and importance

```{r plot_imp_bias}
simdat <- readRDS("../Data/simulation_f3bias.rds")

simdat %>% 
        dplyr::select(model, f3_bias, importance, dispersion) %>%
        dplyr::group_by(f3_bias, model) %>%
        dplyr::summarise(sharpness=mean(dispersion), 
                           avg_imp=mean(importance), 
                           "5% qt"=quantile(importance, probs = 0.05), 
                           #"50% qt"=quantile(importance, probs = 0.50),
                           "95% qt"=quantile(importance, probs = 0.95), 
                         .groups = 'drop') %>% 
        ggplot(aes(x=f3_bias, y =avg_imp, group=model)) +
        geom_line(aes(linetype=model)) +
        scale_linetype_manual(values=c("dashed","twodash", "solid")) +
        labs(x="b (bias of forecaster 3)", y="Importance")
```



## Association between component forecaster dispersion and importance

```{r plot_imp_dispersion}
simdat <- readRDS("../Data/simulation_f3sharp.rds")

simdat %>% 
        dplyr::select(model, f3_sharpness, importance, dispersion) %>%
        dplyr::group_by(f3_sharpness, model) %>%
        dplyr::summarise(sharpness=mean(dispersion), 
                           avg_imp=mean(importance), 
                           "5% qt"=quantile(importance, probs = 0.05), 
                           #"50% qt"=quantile(importance, probs = 0.50),
                           "95% qt"=quantile(importance, probs = 0.95), 
                         .groups = 'drop') %>% 
        ggplot(aes(x=f3_sharpness, y =avg_imp, group=model)) +
        geom_line(aes(linetype=model)) +
        scale_linetype_manual(values=c("dashed","twodash", "solid")) +
        labs(x="s (standard deviation of forecaster 3)",
             #title="Importance of three forecasters by different dispersion of forecaster 3", 
             y="Importance") 
```

